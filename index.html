<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sebastian's Silly App</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="src/styles/main.css">
</head>
<body>
    <div id="root"></div>
    
    <!-- Load audio utilities first to make functions globally available -->
    <script type="text/babel">
        // Audio utility functions for Sebastian's Silly App

        // Text-to-speech function
        const speakText = (text, onEnd) => {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.8;
                utterance.pitch = 1.2;
                utterance.volume = 0.8;
                
                if (onEnd) {
                    utterance.onend = onEnd;
                }
                
                window.speechSynthesis.speak(utterance);
                return true;
            }
            return false;
        };

        // Stop speech synthesis
        const stopSpeech = () => {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
            }
        };

        // Pop sound for game
        const playPopSound = () => {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.1);
                
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.1);
            } catch (error) {
                console.log('Audio not supported, playing without sound');
            }
        };

        // Real puppy bark sound using audio file
        const playBarkSound = () => {
            console.log('üêï Attempting to play bark sound...');
            
            try {
                const audio = new Audio('./dog-bark.mp3');
                audio.volume = 0.7;
                
                // Add event listeners for debugging
                audio.addEventListener('loadstart', () => {
                    console.log('üìÑ Audio loading started...');
                });
                
                audio.addEventListener('canplay', () => {
                    console.log('‚úÖ Audio can play!');
                });
                
                audio.addEventListener('error', (e) => {
                    console.log('‚ùå Audio error:', e);
                    console.log('üîÑ Falling back to synthesized bark');
                    playFallbackBarkSound();
                });
                
                // Attempt to play
                const playPromise = audio.play();
                
                if (playPromise !== undefined) {
                    playPromise
                        .then(() => {
                            console.log('üéâ Bark sound playing successfully!');
                        })
                        .catch(error => {
                            console.log('‚ùå Play failed:', error.message);
                            console.log('üîÑ Using fallback bark sound');
                            playFallbackBarkSound();
                        });
                }
                
            } catch (error) {
                console.log('‚ùå Audio setup failed:', error);
                playFallbackBarkSound();
            }
        };

        // Chomp sound for when Buddy eats
        const playChompSound = () => {
            console.log('üçΩÔ∏è Attempting to play chomp sound...');
            
            try {
                const audio = new Audio('./Chomp.mp3');
                audio.volume = 0.6; // Slightly quieter than bark
                
                // Add event listeners for debugging
                audio.addEventListener('loadstart', () => {
                    console.log('üìÑ Chomp audio loading started...');
                });
                
                audio.addEventListener('canplay', () => {
                    console.log('‚úÖ Chomp audio can play!');
                });
                
                audio.addEventListener('error', (e) => {
                    console.log('‚ùå Chomp audio error:', e);
                    console.log('üîÑ No chomp sound available');
                });
                
                // Attempt to play
                const playPromise = audio.play();
                
                if (playPromise !== undefined) {
                    playPromise
                        .then(() => {
                            console.log('üéâ Chomp sound playing successfully!');
                        })
                        .catch(error => {
                            console.log('‚ùå Chomp play failed:', error.message);
                        });
                }
                
            } catch (error) {
                console.log('‚ùå Chomp audio setup failed:', error);
            }
        };

        // Sniff sound for when Buddy is sniffing around
        const playSniffSound = () => {
            console.log('üëÉ Attempting to play sniff sound...');
            
            try {
                const audio = new Audio('./dog-sniff.mp3');
                audio.volume = 0.4; // Quieter since it plays more frequently
                
                // Add event listeners for debugging
                audio.addEventListener('loadstart', () => {
                    console.log('üìÑ Sniff audio loading started...');
                });
                
                audio.addEventListener('canplay', () => {
                    console.log('‚úÖ Sniff audio can play!');
                });
                
                audio.addEventListener('error', (e) => {
                    console.log('‚ùå Sniff audio error:', e);
                    console.log('üîÑ No sniff sound available');
                });
                
                // Attempt to play
                const playPromise = audio.play();
                
                if (playPromise !== undefined) {
                    playPromise
                        .then(() => {
                            console.log('üéâ Sniff sound playing successfully!');
                        })
                        .catch(error => {
                            console.log('‚ùå Sniff play failed:', error.message);
                        });
                }
                
            } catch (error) {
                console.log('‚ùå Sniff audio setup failed:', error);
            }
        };

        // Fallback synthesized bark sound
        const playFallbackBarkSound = () => {
            console.log('üîä Playing fallback synthesized bark');
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                const createBarkComponent = (frequency, startTime, duration, volume) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    const filter = audioContext.createBiquadFilter();
                    
                    filter.type = 'lowpass';
                    filter.frequency.setValueAtTime(800, audioContext.currentTime);
                    
                    oscillator.connect(filter);
                    filter.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime + startTime);
                    oscillator.frequency.exponentialRampToValueAtTime(frequency * 0.3, audioContext.currentTime + startTime + duration);
                    
                    gainNode.gain.setValueAtTime(0, audioContext.currentTime + startTime);
                    gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + startTime + 0.02);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + startTime + duration);
                    
                    oscillator.start(audioContext.currentTime + startTime);
                    oscillator.stop(audioContext.currentTime + startTime + duration);
                };
                
                createBarkComponent(180, 0, 0.15, 0.3);
                createBarkComponent(320, 0.05, 0.12, 0.25);
                createBarkComponent(480, 0.08, 0.08, 0.2);
                
                setTimeout(() => {
                    createBarkComponent(200, 0, 0.12, 0.25);
                    createBarkComponent(340, 0.03, 0.1, 0.2);
                }, 250);
                
            } catch (error) {
                console.log('‚ùå Even fallback audio failed:', error);
            }
        };

        // Make functions globally available
        window.speakText = speakText;
        window.stopSpeech = stopSpeech;
        window.playPopSound = playPopSound;
        window.playBarkSound = playBarkSound;
        window.playChompSound = playChompSound;
        window.playSniffSound = playSniffSound;
    </script>
    
    <!-- Load components in order -->
    <script type="text/babel" src="src/components/ButtonsTab.js"></script>
    <script type="text/babel" src="src/components/DrawTab.js"></script>
    <script type="text/babel" src="src/components/PianoTab.js"></script>
    <script type="text/babel" src="src/components/StoryTab.js"></script>
    <script type="text/babel" src="src/components/MemoryTab.js"></script>
    <script type="text/babel" src="src/components/WeatherTab.js"></script>
    <script type="text/babel" src="src/components/GameTab.js"></script>
    <script type="text/babel" src="src/components/PuppyTab.js"></script>
    <script type="text/babel" src="src/App.js"></script>
</body>
</html>